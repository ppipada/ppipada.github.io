<!doctype html>
<html lang="en"><head>
    <title>Scramblings</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="" />

    
    
    
    <link rel="stylesheet" href="../../css/theme.min.css">

    
    
    
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PVSXVYRTKF"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-PVSXVYRTKF', { 'anonymize_ip': false });
}
</script>

</head>
<body>
        <div id="content" class="mx-auto"><header class="container mt-sm-2 mt-1 mb-1 mt-xs-1">
    <div class="row">
        
        <div class="col-sm-4 col-12 text-sm-right text-center pt-sm-4">
            <a href="../../" class="text-decoration-none">
                <img id="home-image" class="rounded-circle"
                    
                        
                            src="../../images/logo.png"
                        
                    
                />
            </a>
        </div>
        <div class="col-sm-8 col-12 text-sm-left text-center">
        
            <h2 class="m-0 mt-4">
                <a href="../../" class="text-decoration-none">
                    
                        Scramblings
                    
                </a>
            </h2>
            <p class="text-muted">
                
                    Dev scratchpad. Digital garden
                
            </p>
            <ul id="nav-links" class="list-inline" style="list-style: none; padding: 0; height: 1.2em; line-height: 1em; font-size: medium;">
                
                
                    <li style="display: inline;">
                        <a class="badge badge-white " href="../../tags/" title="Tags">Tags</a>
                    </li>
                
                    <li style="display: inline;">
                        <a class="badge badge-white " href="../../quotes/" title="Quotes">Quotes</a>
                    </li>
                
                    <li style="display: inline;">
                        <a class="badge badge-white " href="../../movies/" title="Movies">Movies</a>
                    </li>
                
                
                    <li style="display: inline;">
                        <a class="badge badge-white" href="https://flexigpt.site/" target="_blank" title="">
                            FlexiGPT
                            <i class="fa fa-external-link-square-alt"></i>
                        </a>
                    </li>
                
            </ul>
            <div id="breadcrumbs-container" style="height: 1.2em; line-height: 1em; margin: 0; overflow: hidden; font-size: small;">
<ul id="breadcrumbs" style="list-style: none; padding: 0;">


<li style="display: inline;"><a href="../../" style="color: grey;"><i class="fas fa-home" st></i></a></li>

    
<li style="display: inline;"><span style="color: grey;">&gt;</span>
<a href="../../posts/" style="color: grey;">Posts</a>
</li>


<li style="display: inline;"><span style="color: grey;">&gt;</span></li>

</ul>
</div>

        </div>
    </div>
    <hr />
</header>
<div class="container">
<div class="pl-sm-4 ml-sm-5">
  <div style="margin-bottom: 3rem">
    <h1 style="text-align: center">Python Helpers - Closures</h1>
    <div style="display: flex; justify-content: space-between; align-items: center; font-size: 1em; color: #6c757d; height: 1.2em; line-height: 1em; padding: 0.25em;">
        <div>
        Nov 9, 2019
        </div>
        <div>
        <i class="fa fa-tags"></i>
        
            <a href="../../tags/python" style="color: #6c757d; text-decoration: none;">python</a>
        
        </div>
    </div>
  </div><div class="mt-1 mb-5">
  
</div>
<p>A script to chain multiple closures in python with example usage.</p>
<h2 id="closure-chaining">Closure chaining</h2>




<div class="highlight"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> wraps
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># A new closure will be returned as a chain of Closures in the incoming list order</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">chain_closures</span>(closure_list<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> closure_list:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">chain</span>(f):
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">@wraps</span>(f)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">r</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>            newfunc <span style="color:#f92672">=</span> f
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> reversed(closure_list):
</span></span><span style="display:flex;"><span>                newfunc <span style="color:#f92672">=</span> c(newfunc)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> newfunc(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> r
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> chain</span></span></code></pre></div></div>

<h2 id="example">Example</h2>




<div class="highlight"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> wraps
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> closures <span style="color:#f92672">import</span> chain_closures
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> logging
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>logger <span style="color:#f92672">=</span> logging<span style="color:#f92672">.</span>getLogger()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">x</span>(a):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">request_logger</span>(f):
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">@wraps</span>(f)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rlog</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>            logger<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> x entry&#34;</span>, a)
</span></span><span style="display:flex;"><span>            ret <span style="color:#f92672">=</span> f(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>            logger<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> x exit&#34;</span>, a)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> ret
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> rlog
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> request_logger
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">y</span>(b):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">request_logger</span>(f):
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">@wraps</span>(f)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rlog</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>            logger<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> y entry&#34;</span>, b)
</span></span><span style="display:flex;"><span>            ret <span style="color:#f92672">=</span> f(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>            logger<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> y exit&#34;</span>, b)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> ret
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> rlog
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> request_logger
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">z</span>(a, b):
</span></span><span style="display:flex;"><span>    c1 <span style="color:#f92672">=</span> x(a)
</span></span><span style="display:flex;"><span>    c2 <span style="color:#f92672">=</span> y(b)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">request_logger</span>(f):
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">@wraps</span>(f)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rlog</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>            q <span style="color:#f92672">=</span> c1(c2(f))
</span></span><span style="display:flex;"><span>            logger<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;z entry&#34;</span>)
</span></span><span style="display:flex;"><span>            ret <span style="color:#f92672">=</span> q(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>            logger<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;z exit&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> ret
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> rlog
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> request_logger
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">w</span>(a, b, f):
</span></span><span style="display:flex;"><span>    c1 <span style="color:#f92672">=</span> x(a)
</span></span><span style="display:flex;"><span>    c2 <span style="color:#f92672">=</span> y(b)
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> c1(c2(f))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> q
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_w</span>(a, b):
</span></span><span style="display:flex;"><span>    c1 <span style="color:#f92672">=</span> x(a)
</span></span><span style="display:flex;"><span>    c2 <span style="color:#f92672">=</span> y(b)
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> chain_closures([c1, c2])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> q
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f1</span>(a, b):
</span></span><span style="display:flex;"><span>    logger<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span>, a, b)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># raise Exception(&#34;me except&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">smain</span>():
</span></span><span style="display:flex;"><span>    c4 <span style="color:#f92672">=</span> get_w(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>)
</span></span><span style="display:flex;"><span>    f2 <span style="color:#f92672">=</span> c4(f1)
</span></span><span style="display:flex;"><span>    f2(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>)
</span></span><span style="display:flex;"><span>    logger<span style="color:#f92672">.</span>info(f2<span style="color:#f92672">.</span>__name__)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    logging<span style="color:#f92672">.</span>basicConfig(format<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%(asctime)s</span><span style="color:#e6db74"> - </span><span style="color:#e6db74">%(message)s</span><span style="color:#e6db74">&#39;</span>, datefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">-%b-%y %H:%M:%S&#39;</span>, level<span style="color:#f92672">=</span>logging<span style="color:#f92672">.</span>DEBUG)
</span></span><span style="display:flex;"><span>    smain()
</span></span></code></pre></div></div>


</div>

            </div>
        </div><footer class="text-center pb-1">
  <ul id="nav-social" class="list-inline mb-1">
    
    <li class="list-inline-item mr-3">
      <a href="https://github.com/ppipada" target="_blank">
        <i class="fab fa-github fa-1x text-muted"></i>
      </a>
    </li>
    
    <li class="list-inline-item mr-3">
      <a href="https://www.linkedin.com/in/ppipada" target="_blank">
        <i class="fab fa-linkedin-in fa-1x text-muted"></i>
      </a>
    </li>
    
    <li class="list-inline-item mr-3">
      <a href="mailto:ppipada@gmail.com" target="_blank">
        <i class="fas fa-at fa-1x text-muted"></i>
      </a>
    </li>
    
    <li class="list-inline-item mr-3">
      <a href="https://pankajpipada.com/index.xml" target="_blank">
        <i class="fas fa-rss fa-1x text-muted"></i>
      </a>
    </li>
    
  </ul>
  <span class="text-muted" style="font-size:0.8em">
     Copyright © 2016-2024 Pankaj Pipada. All Rights Reserved. 
    <br />
  </span>
</footer>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>

        
    </body>
</html>
